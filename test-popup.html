<!DOCTYPE html>
<html>

<head>
    <title></title>
</head>
<style type="text/css">
html,
body {
    padding: 0;
    margin: 0;
    width: 100%;
    height: 100%;
}

table {
    border-collapse: collapse;
    border: none;
    width: 200px;
}


/* å¿…è¦*/
th {
    padding: 10px;
    border: solid #000 1px;
}

td {
    padding: 10px;
    border: solid #000 1px;
}

.hidden {
    display: none;
}

.show {
    display: '';
}

input:focus {
    outline: medium;
}

.mm-popup {
    -moz-user-select: none;
    /*ç«ç‹*/
    -webkit-user-select: none;
    /*webkitæµè§ˆå™¨*/
    -ms-user-select: none;
    /*IE10*/
    -khtml-user-select: none;
    /*æ—©æœŸæµè§ˆå™¨*/
    user-select: none;
}

/* å¿…è¦ */
</style>

<body>
    <div style="height: 100%;display: flex;align-items: center;justify-content: center; ">
        <table id="myTable" border="1" style="width: 400px;text-align: center;">
            <tr>
                <th>è¡¨å¤´1</th>
                <th>è¡¨å¤´2</th>
                <th>è¡¨å¤´3</th>
            </tr>
            <tr>
                <td>
                    æˆ‘æ˜¯æ•°æ®1
                </td>
                <td>æˆ‘æ˜¯æ•°æ®1</td>
                <td>æˆ‘æ˜¯æ•°æ®1</td>
            </tr>
            <tr>
                <td>æˆ‘æ˜¯æ•°æ®2</td>
                <td>æˆ‘æ˜¯æ•°æ®2</td>
                <td>æˆ‘æ˜¯æ•°æ®2</td>
            </tr>
            <tr>
                <td>æˆ‘æ˜¯æ•°æ®3</td>
                <td>æˆ‘æ˜¯æ•°æ®3</td>
                <td>æˆ‘æ˜¯æ•°æ®3</td>
            </tr>
            <tr>
                <td>æˆ‘æ˜¯æ•°æ®4</td>
                <td>æˆ‘æ˜¯æ•°æ®4</td>
                <td>æˆ‘æ˜¯æ•°æ®4</td>
            </tr>
        </table>
    </div>
    <script type="text/javascript">
    let myTable = document.getElementById("myTable");
    let trs = document.getElementsByTagName("tr")
    for (let i = 0; i < trs.length; i++) {
        let trChildren = trs[i].children;
        for (let j = 0; j < trChildren.length; j++) {
            trChildren[j].style.position = 'relative';
            trChildren[j].innerHTML += createHtmlString(`${i}-${j}`);
            trChildren[j].addEventListener('click', function(e) {
                let dom = document.getElementById(`${i}-${j}`);
                if (dom.getAttribute('class') === 'hidden mm-popup') {
                    dom.setAttribute("class", "show mm-popup");
                } else {
                    dom.setAttribute("class", "hidden mm-popup");
                }
            }, false)
        }
    }

    function createHtmlString(id) {
        return `
        <div id="${id}" class="hidden mm-popup" style="position: absolute;left: 50%;top: 0;transform: translate(-50%,-100%);z-index: 99;padding: 5px;">
            <div style="text-align: left;">
                <div style="background-color: #fff;background-clip: padding-box;border-radius: 2px;box-shadow: 0 3px 6px -4px rgb(0 0 0 / 12%), 0 6px 16px 0 rgb(0 0 0 / 8%), 0 9px 28px 8px rgb(0 0 0 / 5%);box-shadow: 0 0 8px rgba(0,0,0,.15)/9;">
                    <div style="margin: 0;padding: 8px 16px;color: rgba(0,0,0,.85);font-weight: 500;border-bottom: 1px solid #f0f0f0;display: flex;align-items: center;justify-content: space-between;">
                        <div>
                            Title
                        </div>
                        <div is-selected="false" onclick="onClickLock(this)">
                            ğŸ”“
                        </div>
                    </div>
                    <div style="padding: 12px 16px;color: rgba(0,0,0,.85);">
                        <div style="border: 1px solid #000;padding: 5px;border-radius: 5px;">
                            <div style="display: flex;align-items: center;justify-content: space-between;">
                                <div>
                                    <input type="text" placeholder="filter key" name="" style="border: 0;height: 30px;" onclick="onClickInput(this)" onkeydown="keyDown(event,this)">
                                </div>
                                <div is-selected="false" style="border-radius: 5px;margin-left: 2px;padding: 5px;text-align: center; width: 25px;" onclick="onClickCaps(this)">
                                    Aa
                                </div>
                                <div is-selected="false" style="border-radius: 5px;margin-left: 2px;padding: 5px;text-align: center; width: 25px;" onclick="onClickGlobal(this)">
                                    .*
                                </div>
                            </div>
                         </div>
                    </div>
                </div>
            </div>
        </div>
    `
    }

    //ç‚¹å‡»è¾“å…¥æ¡†
    function onClickInput(obj) {
        console.log("input")
        stopPropagation(event)
    }

    //å›è½¦
    function keyDown(e, obj) {
        if (e.key === 'Enter') {
            console.log(obj.value)
        }
    }

    //ç‚¹å‡»å¤§å°å†™
    function onClickCaps(obj) {
        console.log("caps")
        //çŠ¶æ€
        updateSelectState(obj)
        stopPropagation(event)
    }

    //ç‚¹å‡»é”
    function onClickLock(obj) {
        console.log("lock")
        updateLockSelectState(obj)
        stopPropagation(event)
    }

    //ç‚¹å‡»å…¨å±€æœç´¢
    function onClickGlobal(obj) {
        console.log("global")
        updateSelectState(obj)
        stopPropagation(event)
    }



    //æ”¹å˜é”çŠ¶æ€
    function updateLockSelectState(obj) {
        let isSelected = obj.getAttribute("is-selected")
        if (isSelected === 'false') {
            obj.setAttribute("is-selected", "true")
            obj.innerHTML = 'ğŸ”’'
        } else {
            obj.setAttribute("is-selected", "false")
            obj.innerHTML = 'ğŸ”“'
        }
    }


    //æ”¹å˜çŠ¶æ€
    function updateSelectState(obj) {
        let isSelected = obj.getAttribute("is-selected")
        if (isSelected === 'false') {
            obj.setAttribute("is-selected", "true")
            obj.style.background = "#000";
            obj.style.color = "#FFF";
        } else {
            obj.setAttribute("is-selected", "false")
            obj.style.background = "#FFF";
            obj.style.color = "#000";
        }
    }

    //é˜»æ­¢äº‹ä»¶å†’æ³¡
    function stopPropagation() {
        if (event && event.stopPropagation) {
            event.stopPropagation();
        } else {
            window.event.cancelBubble = true;
        }
    }
    </script>
</body>

</html>